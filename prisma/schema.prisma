generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id          Int       @id @default(autoincrement())
  name        String    @db.VarChar(100)
  email       String    @unique(map: "email") @db.VarChar(100)
  password    String    @db.VarChar(255)
  role_id     Int?
  role        String    @db.VarChar(50)
  is_active   Boolean   @default(true)
  login_count Int?      @default(0)
  last_login  DateTime? @db.DateTime(0)
  created_at  DateTime  @default(now()) @db.Timestamp(0)

  @@index([role_id], map: "role_id")
  @@map("users")
}

model Role {
  id        Int    @id @default(autoincrement())
  role_name String @db.VarChar(100)

  @@map("roles")
}

model TransportRequest {
  id                    Int      @id @default(autoincrement())
  user_id               Int
  nama                  String   @db.VarChar(100)
  jabatan               String?  @db.VarChar(100)
  bagian                String?  @db.VarChar(100)
  macam_kendaraan       String?  @db.VarChar(50)
  jumlah_penumpang      Int?
  tujuan                String   @db.Text
  keperluan             String   @db.Text
  tanggal_jam_berangkat DateTime @db.DateTime(0)
  lama_pakai            String?  @db.VarChar(50)
  status                String?  @default("Pending Asmen") @db.VarChar(50)
  barcode_pemohon       String?  @db.VarChar(255)
  created_at            DateTime @default(now()) @db.Timestamp(0)
  updated_at            DateTime @default(now()) @db.Timestamp(0)

  @@index([user_id], map: "user_id")
  @@map("transport_requests")
}

model TransportApproval {
  id            Int       @id @default(autoincrement())
  request_id    Int
  asmen_id      Int?
  is_approved   Boolean?
  catatan       String?   @db.Text
  approved_at   DateTime? @db.DateTime(0)
  barcode_asmen String?   @db.VarChar(255)

  @@index([request_id], map: "request_id")
  @@map("transport_approvals")
}

model TransportFleet {
  id            Int      @id @default(autoincrement())
  request_id    Int
  admin_id      Int?
  mobil         String?  @db.VarChar(100)
  plat_nomor    String?  @db.VarChar(20)
  pengemudi     String?  @db.VarChar(100)
  barcode_fleet String?  @db.VarChar(255)
  created_at    DateTime @default(now()) @db.Timestamp(0)

  @@index([request_id], map: "request_id")
  @@map("transport_fleet")
}

model TransportSecurityLog {
  id                    Int       @id @default(autoincrement())
  request_id            Int
  km_awal               Int?
  km_akhir              Int?
  jam_berangkat         DateTime? @db.DateTime(0)
  jam_kembali           DateTime? @db.DateTime(0)
  lama_waktu            String?   @db.VarChar(50)
  jarak_tempuh          Int?
  foto_driver_berangkat String?   @db.VarChar(255)
  foto_km_berangkat     String?   @db.VarChar(255)
  foto_driver_kembali   String?   @db.VarChar(255)
  foto_km_kembali       String?   @db.VarChar(255)
  logged_by             Int?
  created_at            DateTime  @default(now()) @db.Timestamp(0)
  updated_at            DateTime  @default(now()) @db.Timestamp(0)

  @@index([request_id], map: "request_id")
  @@map("transport_security_logs")
}

model TransportVehicleType {
  id          Int     @id @default(autoincrement())
  type_name   String  @db.VarChar(50)
  description String? @db.Text

  @@map("transport_vehicle_types")
}

model TransportVehicle {
  id              Int     @id @default(autoincrement())
  brand           String  @db.VarChar(50)
  plat_nomor      String  @unique(map: "plat_nomor") @db.VarChar(20)
  model           String? @db.VarChar(100)
  tahun           Int?
  status          String? @default("Available") @db.VarChar(20)
  last_request_id Int?

  @@map("transport_vehicles")
}

model NotifikasiAktivitas {
  id              Int       @id @default(autoincrement())
  user_id         Int?
  email           String?   @db.VarChar(100)
  role            String?   @db.VarChar(50)
  jenis_aktivitas String?   @db.VarChar(50)
  module          String?   @db.VarChar(100)
  record_id       Int?
  record_name     String?   @db.VarChar(255)
  menu_diakses    String?   @db.VarChar(100)
  deskripsi       String?   @db.Text
  tanggal_waktu   DateTime? @db.DateTime(0)
  status_baca     Boolean?  @default(false)
  ip_address      String?   @db.VarChar(50)
  user_agent      String?   @db.Text

  @@map("notifikasi_aktivitas")
}

model NotifikasiReadStatus {
  id              Int      @id @default(autoincrement())
  notification_id Int
  user_id         Int
  read_at         DateTime @db.DateTime(0)

  @@index([notification_id], map: "notification_id")
  @@index([user_id], map: "user_id")
  @@map("notifikasi_read_status")
}
